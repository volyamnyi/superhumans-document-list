export const medicineListData = [
  {
    id: 1,
    MedicineListRef:1,
    medicineName: "Aspirin",
    medicineMethod: "ВВ",
    medicineDetails: [
      {
        id: 1,
        date: "2024-03-13",
        morning: {
          id: 1,
          time: "08:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 2,
          time: "12:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 3,
          time: "18:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 4,
          time: "22:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
      {
        id: 2,
        date: "2024-03-14",
        morning: {
          id: 5,
          time: "07:30",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 6,
          time: "12:15",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 7,
          time: "18:45",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 8,
          time: "21:50",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
    ],
  },
  {
    id: 2,
    medicineName: "Ibuprofen",
    medicineMethod: "ПМ",
    medicineDetails: [
      {
        id: 3,
        date: "2024-03-12",
        morning: {
          id: 9,
          time: "06:45",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 10,
          time: "13:10",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 11,
          time: "19:20",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 12,
          time: "23:15",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
      {
        id: 4,
        date: "2024-03-13",
        morning: {
          id: 13,
          time: "06:45",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
        },
        day: {
          id: 14,
          time: "13:10",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
        },
        evening: {
          id: 15,
          time: "19:20",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
        },
        night: {
          id: 16,
          time: "23:15",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
        },
      },
      {
        id: 5,
        date: "2024-03-14",
        morning: {
          id: 17,
          time: "06:45",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 18,
          time: "13:10",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
        },
        evening: {
          id: 19,
          time: "19:20",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 20,
          time: "23:15",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
      {
        id: 6,
        date: "2024-03-15",
        morning: {
          id: 21,
          time: "06:45",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 22,
          time: "13:10",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 23,
          time: "19:20",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 24,
          time: "23:15",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
    ],
  },
  {
    id: 3,
    medicineName: "Paracetamol",
    medicineMethod: "ВВ",
    medicineDetails: [
      {
        id: 7,
        date: "2024-03-12",
        morning: {
          id: 25,
          time: "08:10",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 26,
          time: "13:30",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 27,
          time: "18:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 28,
          time: "22:30",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
      {
        id: 8,
        date: "2024-03-14",
        morning: {
          id: 29,
          time: "07:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 30,
          time: "12:20",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 31,
          time: "18:40",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 32,
          time: "23:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
    ],
  },
  {
    id: 4,
    medicineName: "Paracetamol",
    medicineMethod: "ВВ",
    medicineDetails: [
      {
        id: 9,
        date: "2024-03-12",
        morning: {
          id: 33,
          time: "08:10",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 34,
          time: "13:30",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 35,
          time: "18:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 36,
          time: "22:30",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
      {
        id: 10,
        date: "2024-03-14",
        morning: {
          id: 37,
          time: "07:00",
          isChecked: false,
          isPlanned: true,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 38,
          time: "12:20",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 39,
          time: "18:40",
          isChecked: true,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 40,
          time: "23:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
    ],
  },
  {
    id: 5,
    medicineName: "Paracetamol",
    medicineMethod: "ВВ",
    medicineDetails: [
      {
        id: 11,
        date: "2024-03-12",
        morning: {
          id: 41,
          time: "08:10",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 42,
          time: "13:30",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 43,
          time: "18:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 44,
          time: "22:30",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
      {
        id: 12,
        date: "2024-03-14",
        morning: {
          id: 45,
          time: "07:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        day: {
          id: 46,
          time: "12:20",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        evening: {
          id: 47,
          time: "18:40",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
        night: {
          id: 48,
          time: "23:00",
          isChecked: false,
          isPlanned: false,
          isCompleted: false,
          isOverdue: false,
          isFailed: false,
        },
      },
    ],
  },
];
export async function updateMedicineListStatusByListId(id, status, token, sync = false) {
  const url = `http://localhost:8080/api/medicinelist/${id}?status=${status}`;
  const headers = {
    "Authorization": `Bearer ${token}`,
    "Content-Type": "application/json",
  };

  // Standard async PUT request
  if (!sync) {
    console.log(`Updating status: ${status}`);
    return fetch(url, {
      method: "PUT",
      headers: headers,
    });
  }

  // Fallback: Synchronous request on unload (needed for guaranteed execution)
  console.log(`(SYNC) Updating status: ${status}`);
  const xhr = new XMLHttpRequest();
  xhr.open("PUT", url, false); // `false` makes it synchronous
  xhr.setRequestHeader("Authorization", `Bearer ${token}`);
  xhr.setRequestHeader("Content-Type", "application/json");
  xhr.send();
}

React.useEffect(() => {
   
    const token = localStorage.getItem("accessToken"); 

    
    !isScaled && updateMedicineListStatusByListId(id.split("|")[0], "Editing", token);

    const handleVisibilityChange = () => {
      if (document.visibilityState === "hidden") {
        updateMedicineListStatusByListId(id.split("|")[0], "Saved", token, true);
      }
    };

    document.addEventListener("visibilitychange", handleVisibilityChange);
    window.addEventListener("pagehide", handleVisibilityChange);

    return () => {
      document.removeEventListener("visibilitychange", handleVisibilityChange);
      window.removeEventListener("pagehide", handleVisibilityChange);
    };
  }, [id]);